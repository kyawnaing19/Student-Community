<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Community </title>
    <!-- ------------------Custom Css link -->
    <link rel="stylesheet" href="./Assets/Fstyle.css">
    <!-- ----Font Awesome  -->
    <link rel="stylesheet" href="./fontawesome-free-6.3.0-web/css/all.css">     <!-- -------Swiper Slider Link------ -->

    <link rel="stylesheet" href="./Assets/Swiper/swiper-bundle.min.css">

</head>

<body>


    <!-- ..................Start Navbar...................... -->
    <nav>
        <div class="container nav-container">
            <div class="logo">
                <h3>Community <span>Forum</span></h3>
            </div>
            <div class="serch-bar">
                <i class="fa fa-search"></i>
                <input type="search" name="" id="search" placeholder="Search For Creators">
            </div>
            <div class="add-post">
                <label for="add-post" class="btn btn-primary">Add Post</label>
                <div class="profile-picture" id="my-profile-picture">
                    <img src="./Assets/images/img/profile-1.jpeg" alt="">
                </div>
            </div>
        </div>
    </nav>
    <!-- ...................Start Navbar................... -->


    <!-- ...................Start Main Session...................-->
    <main>
        <div class="container main-container">

            <!-- ...........Main Left Start......... -->
            <div class="main-left">

                <!--..................... Profile Start.............. -->
                <a class="profile">
                    
                    <div class="profile-handle">
                        <h2>Friends</h2>
                        
                    </div>
                </a>

                <!--..................... Profile End.............. -->

                <!-- ............Start Aside Bar............... -->
                <aside>
                    <a class="menu-item" href="home">
                        <span>
                            <img src="./Assets/images/svg/house-door.svg" alt="">
                        </span>
                        <h3>Home</h3>
                    </a>

                    <a class="menu-item" href="#">
                        <span>
                            <img src="./Assets/images/svg/reshot-icon-user-arrow-right-4N3DKYSTC8.svg" alt="">
                        </span>
                        <h3>Friend Requests</h3>
                    </a>

                   

                    <a class="menu-item" href="allFriends">
                        <span>
                            <img src="./Assets/images/svg/reshot-icon-user-information-6254SPQUFY.svg" alt="">
                        </span>
                        <!-- <small class="notfy-counter">3</small> -->
                        <h3>All Friends</h3>
                    </a>

                    <a class="menu-item" href="suggestions">
                        <span>
                            <img src="./Assets/images/svg/add-friend-svgrepo-com (1).svg" alt="">
                        </span>
                        <h3>Suggestions</h3>
                    </a>
                    <!-- ..........Add Post Btn...........-->
                    <label for="add-post" class="btn btn-primary btn-lg"><a href="profile.html" style="text-decoration: none; color: aliceblue; font-weight: bolder;">View Profile Details</a></label>

                </aside>

                <!-- ............End Aside Bar............... -->

            </div>
            <!-- ...........Main Left End......... -->



            <!--======================Main Middle Start====================== -->

            <div class="main-middle" id="container">



            </div>
            <!-- ======================Main Middle End======================-->

            <!-- ...........Main Right Start......... -->
            





        </div>
    </main>
    <!-- ...................End Main Session................... -->




    <!-- -----------------------Start PopUps Aria----------------- -->
    <!-- ----------Start Profile-Popup------------- -->
    <div class="popup profile-popup">
        <div>
            <div class="popup-box profile-popup-box">
                <h1>Aung Khaing Moe</h1>
                <p>@aungkhaingmoe</p>
                <div id="my-profile-picture">
                    <img src="./Assets/images/img/profile-1.jpeg">
                </div>
                <label for="profile-upload" class="btn btn-primary btn-lg"><a href="profile.html" style="text-decoration: none; color: aliceblue; font-weight: bolder;">View Profile Details</a></label>
                <!-- <input type="file" name="" accept="image/jpg , image/png, image/jpep" id="profile-upload"> -->
                <button class="btn btn-primary btn-lg">Log Out</button>
            </div>
            <span class="close"><i class="fa fa-close"></i></span>
        </div>
    </div>
    <!-- ----------End Profile-Popup------------- -->

    <!-- -----------------------End PopUps Aria----------------- -->


    <!-- ----------------Swiper JS---------------------- -->
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script>
        var swiper = new Swiper(".mySwiper", {
            slidesPerView: 8,
            spaceBetween: 10,
            pagination: {
                el: ".swiper-pagination",
                clickable: true,
            },
            navigation: {
                nextEl: ".swiper-button-next",
                prevEl: ".swiper-button-prev",
            },
            direction: 'horizontal', // Ensures horizontal sliding
        });
    </script>

    <script src="./Assets/Swiper/swiper-bundle.min.js"></script>
    <!-- Custom Js Link -->
<!--    <script src="./Assets/Script.js"></script>-->
    <script src="assests/js/jquery.min.js"></script>
    <script>
        var id=sessionStorage.getItem("id");
        $.get('/friend/getFriendRequest', { id: id }, function(response) {
            if (Array.isArray(response)) {
                var usersContainer = $('#container');
                usersContainer.empty(); // Clear any existing content

                response.forEach(function(user) {

                    var userDiv = `
                     <div class="middle-container" ">
                  <div class="friend-profile" style="">
                  <img src="/files/${user.profile}" style="">
                   </div>
                    <div class="card-content">
                       <div onclick="window.location.href='profile?otheremail=${user.email}&otherid=${user.id}'"> <h4>${user.name}</h4></div>
                         <!-- -----------------Liked by-------------- -->

                       <a class="btn-confirm" id="btn-${user.id}" onclick="confirmFunc(${user.id})">Confirm</a>
                       <a class="btn-delete" id="btn1-${user.id}" onclick="cancelFunc(${user.id})">Delete</a>

                    </div>
                </div>
                    `;

                    usersContainer.append(userDiv);
                });
                console.log("success");
            } else {
                console.log('Response is not an array:', response);
            }
        }).fail(function(xhr, status, error) {
            alert('Request failed: ' + error);
        });

        function cancelFunc(userId) {
            $.ajax({
                url: '/friend/deleteFriend', // your delete mapping URL
                type: 'DELETE',
                data: { sender: id, receiver: userId },
                success: function(response) {
                    $('#btn1-'+userId+'').text("Canceled");
                    $('#btn1-'+userId+'').attr('onclick', '');
                    $('#btn-'+userId+'').hide();
                },
                error: function(xhr, status, error) {
                    alert('Request failed: ' + error);
                }
            });
        }

        function  confirmFunc(userId)
        {
            $.ajax({
                url: '/friend/acceptFriend', // your delete mapping URL
                type: 'POST',
                data: { sender: userId, receiver: id },
                success: function(response) {
                    $('#btn-'+userId+'').text("Confirmed");
                    $('#btn-'+userId+'').attr('onclick', '');
                    $('#btn1-'+userId+'').hide();
                },
                error: function(xhr, status, error) {
                    alert('Request failed: ' + error);
                }
            });
        }


    </script>
    <!--serch-->
    <script>
        document.getElementById('search').addEventListener('keydown', function (event) {
            if (event.key === 'Enter') {
                event.preventDefault(); // Prevent the default action (form submission)
                // Perform your action here
                const searchValue = event.target.value;
                console.log('Search value:', searchValue);
                // You can call a function or redirect to a search results page, for example
                window.location.href = `/search?query=${searchValue}`;
            }
        });
    </script>
    <!--serch-->

</body>

</html>